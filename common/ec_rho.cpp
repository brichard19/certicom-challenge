#include <cassert>
#include <stdexcept>

#include "ec_rho.h"

namespace {

// DO NOT MODIFY
// These are deterministically generated and must
// match on all systems.
std::string _ecp131_a_str[] = {
"336D6AAFD0B4EBA54CF107DDA20068839",
"192690B4EA40BF37DC0FBF7E16C38C7A6",
"3CE08168B66FF0FBA035F593B66F982F7",
"169A95D1AB4E39E1B3EAB92CA23666F7C",
"442A402C23CE408F017A8BB7765D292C5",
"11284619240C48EC9A295C34AF860BFA2",
"2B592204185EB8F76D329377FD7653723",
"2772E22D16F5B3D072AFD240530FCBD98",
"0E449DC12725000CC268C7C92A4EBB391",
"1272727FF0A9F2455CE887DE4DE0902DE",
"2752C2E66D0B68E72C307B3335B9AEF8F",
"0C00218BACDE4A4339141C55CDCD31CF4",
"04AFFD2DAE54A9DE884E9C4DC5847569D",
"27BEA15716A0FE021219AD05BBEF1ED5A",
"266C0E49FC16E28AE9DB6D2981B12B83B",
"0E0B91D1C63D71C440666EEC0D15B27E9",
"240F6760EB58F2E2D1E947BADCF991B16",
"052AD15AA8631BA2A1BC83CC97E62DD27",
"1116E49D3FD323B4BAD93C90A6A413F6C",
"30BAE6B74D09FF7E0168910DE53691375",
"244AE103769A5BA7911FFB172D6F56812",
"10AB929AC84ADDEE62047A4C54E2BEA53",
"2BE32ECD2F6EAC3374B55DA4A2F15BA88",
"2C2BF3B6F6092ECBC2B1D13A5290B4541",
"24B69D47E7F387105CB253EAAAD72F04E",
"160717C5FD0D872E270CA974E9A44ABBF",
"1BCB2EA851E35C3638AC345C7ED9BB6E4",
"32B19915B51BCF6D80A9BD915E000294D",
"28054AA84CC147DD16F29CAA0572F0FCA",
"3400FFE5872EC921ECB88A90B35262D6B",
"15CE09AE29C0507CF3CEC97EFB98BB080",
"42F1CE9E81766523487F50E9617366B99",
};

std::string _ecp131_b_str[] = {
"012544750257DB310FDBB403793323965",
"2B56B9581B5095F6931A63E63AC1436C2",
"38E42E37FF380389622B18A84546338C3",
"232DB31CC3AAE18A7857AD8D7FC754BB8",
"1F176F3C3C1D332F5B179E3AB5B9F6FFE",
"0DA7CFC63A4F18D92AEF5E46F133E5F2F",
"37F06E74E41D7CDD371C0561987CDF114",
"1CE73FF551FA27408CAAC7DAA1419593D",
"40DAD09652C34CCC1237F542EF077707A",
"140C71C03C6DD9DCED72AEA738FF635DB",
"4358656FAABF8B73FF4751AAA3C2543B0",
"134B4271DAA36B8644359E4F2B91FC889",
"2F817E06DD01498CD08E3EEA9CEFFD436",
"191D278A769A9C54AB96B2175FA3F08C7",
"157A725024C71E0EB0C185946E8E7FF8C",
"1AFB801ACCA8A7A0070922D059BA3F215",
"02BA17B7D4A094319A8051B0997357732",
"1ED13DDE5D068A006D0B6B063BD7763F3",
"3A6D3FCCBC87296D7FAB4D8F0517220A8",
"38D533FBBF6C174DC684940A77E0E01E1",
"4208F79696BA5B7A5144820A2F9AA756E",
"3EF86AC739D960A029F1CA276B5D4135F",
"484C49E78C6E465033BFA26E7F02AE304",
"0871E71ADA63EA4F8FAF17A46528A63ED",
"2D086669C5A05227132D67F0947C22AEA",
"3CB933037EF131F3E59062CB799CC230B",
"3780AD0E51897176F6E6BD193BAE0C2A0",
"0614CE561A3C046544FD4EFEE8715C439",
"13E168C278296EF7D25D1496E1B2D33A6",
"25E59FD2C85623BBA33F27FA0A3C4DEF7",
"456D9ADF9A4ACBA1BD811918964657B7C",
"1B097EA1E30BBD4F034A470DD2FC90EC5",
};

std::string _ecp131_x_str[] = {
"3E0482F5979C5BDB5C3DA6B6D3231F697",
"1BDA9E5488A5EA4CB4549B6B3504CE964",
"41AE25E46387257083ED02B946036AE2A",
"4411C48F844733FCF18C893BA8BF34B66",
"29C81347F02477AA881F8BD78C2CC340F",
"05FBEE932458F5168918C74FC6AEFD342",
"465564BF8A8970030BC812C320CF81FCE",
"46F29A7A41BF7EDEED312C87B26D2B0EE",
"20EAD2FAB558737EB6F34BF1AF1155D3F",
"172C9D958001BBAE7D21DF7F7FEF9C14A",
"194487BADCC92248D20771BE3D4CC0A90",
"38371C69DFC9CF2539CEAD3DF6ECCFB6A",
"0CE528A352A1846365043D5D0BF06F66E",
"0F1871FF68B3AF3F816572F861D315AD0",
"1C07F41152E16D2C77926F94D646996BA",
"30FEA24281F902BC9FCAA8323EA977E49",
"42E6B3442EC0DD65DE77421A69745D75D",
"260BC14E58C566D98ABB4F3C0855FDCF1",
"2C6724B51DD61470591390A4496F0CDA6",
"44D93FA8AD97E25C7CA2A1899055C00D1",
"120CCA071A4AACF0FDEA7ECCEDF3BF004",
"3B88AE44DDE17B45C0DFF17225962671E",
"06578DFB3E13B5E1D8DFC178C317AAAB7",
"32C8CA78DA349C4356145A93BB3450A11",
"079A2D10BA599840CD7EF814257A6F6A4",
"424D6625CD8FA3463F2CE2563F02FAFFD",
"35301CBC8DEE0714F09DF77028DFFE209",
"03CE2730E33592CAE4D2E9C5EF4ACD22C",
"447AF3688EB78903A073CA0716EFCDF6E",
"11E29207791F310BB82CC13B2933772A3",
"017E7F4C8870AE268E214808C702D3E14",
"3D84C655420305284F1FD507823D79EF5",
};

std::string _ecp131_y_str[] = {
"3387C12B4B615F72CED008F307FF4990A",
"48D99E90023060286F09B800FA662770D",
"0CA1FC5C754252E5670E33D2F4E2DDCA7",
"200A001B671F622F15387052F4D9B4E71",
"1DD07CB8DF80A46DCEB43AA501640AEAB",
"04CD0FAA2515611342D57F8B0EC10BF1C",
"1B8F6A96407FE0F835A7AEF75CBC38F16",
"01754803F4E7370DC39B138075212880C",
"4079BA6AF10773E7D817D659402B3A2EF",
"405D330B424FB451CAC53195B258EB042",
"2F554D62769334E40D9D4CCC21E365E58",
"0EB95070F2946CC355995B5CEC14F2411",
"1C3BDBC907B37945D78856CAF65EEDF81",
"1DACCA25F89D0887727F36FCD3829D543",
"008BD21BC8DAF5841A0C08B74512A71C1",
"449A4D0E56B68A00D72C2E13FC9ED208A",
"13ECB3741F95EB5ECC43DBC3264230678",
"3752081342F36C7A0DFF6087649FD1786",
"2B948A9050A90C775CEB8B641A435AEB3",
"28942C2FD5503295F3911D091CB24D9D7",
"29D2AF574C1C9ABA3AA76E3B7F98D2D87",
"167972AABF862948D9E4D0247CB85531D",
"394717D66321541A62EF40800273C4CB8",
"1309CC0043A4F5F3F3AFA7C9DA60A498E",
"3D259E002E565CD9881C1700221187733",
"33FA6AC08BA5F2771BB6672CCB9CF75FC",
"36605AFBFBEDF61ED763E6877F121F656",
"138E4C14626AC796E3BD6FEA9ACD4E656",
"32337F7E0FBE349DCC3B17153C8436674",
"07664821CBEC201FB6D70D826958F7C47",
"3D3C8B6E19D0644F215DD8070AF7C4EAA",
"31FB51433BEE76FBC188732DC278B964E",
};


// Paramters for curve ecp79
std::string _ecp79_a_str[] = {
"0000000000000103BCF107DDA20068839",
"00000000000001F85B63AD77D6591EE13",
"0000000000000123F92690B4EA40BF37D",
"00000000000001985035F593B66F982F7",
"00000000000005274F00450E9FA4C8B01",
"0000000000000327969A95D1AB4E39E1B",
"00000000000000E0317A8BB7765D292C5",
"00000000000002B63CDE3C9693F9C237F",
"000000000000018521284619240C48EC9",
"00000000000003EABD329377FD7653723",
"0000000000000153DBA1538E2E5A9430D",
"000000000000062B3772E22D16F5B3D07",
"00000000000002DCA268C7C92A4EBB391",
"000000000000016C623392E1BC698D92B",
"00000000000003FB7272727FF0A9F2455",
"00000000000002D00C307B3335B9AEF8F",
"00000000000004CAB118A03B0F8831959",
"0000000000000280AC00218BACDE4A433",
"000000000000052BB84E9C4DC5847569D",
"00000000000003AD80518A0D011E35B17",
"0000000000000241A7BEA15716A0FE021",
"000000000000044919DB6D2981B12B83B",
"0000000000000206B01F23450F338F9E5",
"00000000000004776996970D3E0609F9F",
"00000000000003B890666EEC0D15B27E9",
"00000000000001093AE6F6F8FDED13543",
"00000000000003DA140F6760EB58F2E2D",
"00000000000005F3E1BC83CC97E62DD27",
"00000000000004ACC09C082A30BF210B1",
"000000000000014C4116E49D3FD323B4B",
"00000000000000FA1168910DE53691375",
"00000000000001AA8742A4F98C4DE33AF",
};

std::string _ecp79_b_str[] = {
"000000000000023B4FDBB403793323965",
"00000000000005E07F6D1A450E2A4EB1F",
"0000000000000530EB56B9581B5095F69",
"00000000000001AAD22B18A84546338C3",
"00000000000001D732555A794D851DDAD",
"0000000000000060132DB31CC3AAE18A7",
"00000000000004092A0477BA10020B831",
"00000000000003CFBBDD41AB1D35A2ECB",
"00000000000002B03F176F3C3C1D332F5",
"00000000000002279AEF5E46F133E5F2F",
"000000000000013992CC1091F8912D1F9",
"000000000000055C17F06E74E41D7CDD3",
"00000000000003A96CAAC7DAA1419593D",
"000000000000050AAA8B2418F072DDEB7",
"000000000000020200DAD09652C34CCC1",
"00000000000002806D72AEA738FF635DB",
"0000000000000104798B2E6DCDE8B7085",
"000000000000056F8358656FAABF8B73F",
"000000000000030E64359E4F2B91FC889",
"00000000000005FB314E61D520AB386E3",
"00000000000004F7BF817E06DD01498CD",
"000000000000004A3B96B2175FA3F08C7",
"00000000000002D7B4BFADABB8F30E551",
"0000000000000392757A725024C71E0EB",
"00000000000001C6F70922D059BA3F215",
"000000000000024ABB684F02A4644F34F",
"00000000000002CD32BA17B7D4A094319",
"0000000000000518FD0B6B063BD7763F3",
"000000000000056140909B4BD6CAC9C5D",
"000000000000037DAA6D3FCCBC87296D7",
"000000000000000EA684940A77E0E01E1",
"00000000000002C127AED36E9A46E2FFB",
};

std::string _ecp79_x_str[] = {
"00000000000004E894D9ECE0C3CE21016",
"00000000000000DADA31D590C6E87B199",
"00000000000004993D7CCF103659AB550",
"000000000000045ACF51165A007B01136",
"0000000000000522BED4E9856C1504ECA",
"00000000000005E3D4C86DAC9200B8B74",
"0000000000000208A73DDD29B6478C387",
"0000000000000131CFC9361FEC7E8656A",
"00000000000000982AF6839A5FD8BC5C8",
"0000000000000348D7D127ECCE1565C20",
"00000000000002796B0B9108EDF72AD54",
"00000000000004550795E11B346CC4F9F",
"000000000000026BD0E6AE477E5237F59",
"0000000000000138E1BE03918A89A32E9",
"00000000000006277618C6FDE187CD608",
"00000000000004B55B2E2CFEDC5D4FBEF",
"00000000000002531DFDE45606E19CD7C",
"000000000000061D113834D038711A0D8",
"00000000000001B1EDECE6F87E4C83333",
"00000000000003154BA5760CD7280010E",
"0000000000000062CCC0DB1F5395F5CD9",
"00000000000001E1373C1027B21436626",
"0000000000000454CA4E1120658ECC21D",
"00000000000005EDC27D9A58D0013BE8E",
"0000000000000049620B369A8730B8C16",
"000000000000054438F48F4C853305382",
"0000000000000236D3DBAFB9DA7043A55",
"00000000000002AA8C7695B5323473381",
"00000000000004756AB6180F5EF814668",
"00000000000000B093E409993BF4FB8A4",
"000000000000020C60F83D8154E36ED8F",
"00000000000000DA9AC1836FD8941CAF3",
};

std::string _ecp79_y_str[] = {
"000000000000033D9A86850530F019F14",
"000000000000006D435358AF4F30FF06F",
"0000000000000425EA716390066B926FA",
"0000000000000440E13DFF9ADD1C6B680",
"0000000000000589DE3DADD9D618AF3BF",
"00000000000002CAEE73C938D421BE91B",
"00000000000000023C3F4C21BE8F775E7",
"000000000000027132A7A96973D0ABB93",
"00000000000002C78F8B08DECB64DB141",
"00000000000004221418E57DF342C6CDB",
"00000000000001A7415D4EABC81D06728",
"00000000000003E32351463E6D81327C0",
"00000000000002ADF73FB071C88C07BB1",
"0000000000000449B7EF0FEA208FC3201",
"0000000000000249E33BA4A2D4614162B",
"00000000000001947884A0C4162C0CB9B",
"00000000000004ADD5FE446D0B0C1CB32",
"00000000000001DF9DF4B1FF09C844409",
"000000000000007BD3AA6A24C2E84CD6D",
"000000000000004A440EACD1228E19DF6",
"00000000000000052C46A67A7D7269739",
"000000000000036322F97ADD48C13F6BF",
"00000000000001C242636176767C7BBC3",
"000000000000010DA32501AA528C7761D",
"0000000000000394B3E132CBA1B6ED875",
"00000000000003AAE073FAC1FE4888D81",
"000000000000058A9C18BE4776BB6F1A9",
"000000000000002AC8326FD24E681747A",
"0000000000000315A4C475494E084E4AC",
"00000000000004E5CE2EB72BE73DB53BF",
"000000000000008E55732FA6B4C55D572",
"000000000000049362D527FF989E29D9D",
};

}

std::vector<RWPoint> get_rw_points()
{
  std::vector<RWPoint> rw_vec;

  for(int i = 0; i < 32; i++) {
    RWPoint rw;

    if(ecc::curve_name() == "ecp131") {
      rw.a = make_uint131(_ecp131_a_str[i]);
      rw.b = make_uint131(_ecp131_b_str[i]);
      rw.p = ecc::ecpoint_t(make_uint131(_ecp131_x_str[i]), make_uint131(_ecp131_y_str[i]));
    } else if(ecc::curve_name() == "ecp79") {
      rw.a = make_uint131(_ecp79_a_str[i]);
      rw.b = make_uint131(_ecp79_b_str[i]);
      rw.p = ecc::ecpoint_t(make_uint131(_ecp79_x_str[i]), make_uint131(_ecp79_y_str[i]));
    } else {
      throw std::runtime_error("No curve selected");
    }

    // Validate
    ecc::ecpoint_t p = ecc::add(ecc::mul(rw.a, ecc::g()), ecc::mul(rw.b, ecc::q()));

    assert(ecc::is_equal(p, rw.p));

    rw_vec.push_back(rw);
  }

  return rw_vec;
}