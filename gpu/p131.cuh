#ifndef _P131_CUH
#define _P131_CUH

#include "uint131.cuh"

// ECCp-131 P
__constant__ uint131_t _p = {{0x194c43186b3abc0b, 0x8e1d43f293469e33, 0x4}};

__constant__ uint131_t _k = {{0xe0587d72985b105d, 0xf1fd54b0309e1ab9, 0x7cfd70cf}};

// P - 2, used in the inverse function
__constant__ uint64_t _p_minus_2[] = {0x194c43186b3abc09, 0x8e1d43f293469e33, 0x4};

// r = inv(2^160) mod p
//__constant__ uint131_t _rinv = {{0xea2b4033, 0xc3523a9c, 0xabc154a6, 0x3958a1b5, 0x02}};

// r^2 mod P
__constant__ uint131_t _r2 = {{0xf95d709f92600513, 0xf3d6fa1fb65ef639, 0x3}};

// 1 * r mod P
__constant__ uint131_t _one = {{0x6e7743da32b6d0c7, 0x88c614d64c1a8f0b, 0x00}};

// ECCp-131 a in montgomery form
__constant__ uint131_t _a = {{0xe7f7f250cee8709a, 0xacd15fe1a8ec1522, 0x00}};

// ECCp-131 a in montgomery form
__constant__ uint131_t _b = {{0xc85087e5ab4eca9e, 0xde124657d7ba5851, 0x2}};

__constant__ uint131_t _zero = {{0, 0, 0}};


__device__ uint131_t _gx[131] = {
{{0xB137748018DF6458,0xB188BA8CD2A386D9,0x00}},
{{0xF8E80FF3407E0060,0xD66106C66F396132,0x02}},
{{0x66CC597EB44D3899,0xDF4CD21CCEFCF46E,0x00}},
{{0x1E57C6283919FE6C,0x2122ACA4A6D5C506,0x02}},
{{0x9F2055654B613C44,0xA10264FBA91E7A80,0x02}},
{{0x146C76A5A9559023,0x48B8392446FDDFA3,0x03}},
{{0x25BC9CA7F50A9DD0,0x528EC0EF86744A2D,0x01}},
{{0x36713D77E49FC720,0xF074FCF9203C9143,0x02}},
{{0xA3F3FE8B30F1EC55,0xAAAFA9028B299E78,0x03}},
{{0x1326ABCF8EFC57DE,0xC432B1AEBF2AB950,0x02}},
{{0x019DA07CFB6BF673,0x3AFD8E581B2AE49C,0x00}},
{{0x09AB0E9EB3BDC146,0x81D8822F4001F81B,0x03}},
{{0x54006B2D373A605D,0x690B386722E6884E,0x01}},
{{0x22A3AD64FD70D35F,0xEE6ED7CE186356CF,0x03}},
{{0x22D01217946899BA,0xE08F9D1E36378DCC,0x02}},
{{0xCC23A7CDCFDD1696,0x9FEF877550795C70,0x03}},
{{0xF7B2C0150D6CA89A,0x678108A2FE7222D5,0x01}},
{{0xD26AD803959AECE0,0x34CDFA8202F05225,0x01}},
{{0x6A2542224D0DD49E,0xF0EFEBCA34C22400,0x02}},
{{0x9521567B2CA9E502,0x65085B7A89EE4CAE,0x02}},
{{0x56ADD35536E800CB,0xA63F8CEDDE780BE0,0x00}},
{{0x26BE2174A7D36001,0xA21D440303E13053,0x01}},
{{0x21A9B951A09FA10C,0x3EFACB3969A07B03,0x01}},
{{0x040C8AC700693F13,0xC5AF3308170CB5E1,0x03}},
{{0x26103714BF629A51,0x8774D8E86B2749F1,0x00}},
{{0x57544CC53F0FBB72,0x6D9E8945687F2A92,0x00}},
{{0x2E7C9CB7621B9B52,0x19A869EB3EAA4739,0x04}},
{{0xC7525402E95A2791,0xBBC1F588ACC5DC8F,0x01}},
{{0xB521498D45A3E3D6,0xF8FEA38C91B34D14,0x02}},
{{0x916D958887BFAB2E,0xA4793CD801371F70,0x01}},
{{0x9F2CE4FF71F432F8,0x043F5E69BC6B001F,0x01}},
{{0x9DAF283AE971BD49,0x6FE1072CE026E534,0x00}},
{{0x0294C5E2AB903256,0x1DD716AD39CC0742,0x01}},
{{0x8F7417A43D37BDA1,0xC8B4F27700A0DC0B,0x00}},
{{0x6D6279AE8A9228D2,0x702353F352976262,0x00}},
{{0x50A50B3CEF89C77F,0x914A19CAE9832F37,0x00}},
{{0xBF0205063B43B389,0x3F794CEE7A5C02F6,0x02}},
{{0xD68DB807535F6560,0xFAD73553AB33C9BA,0x02}},
{{0xFA281E2EB84FD670,0xD5E16FD04901EC3A,0x01}},
{{0x4A6FEAF1357F2BD6,0xAD9714BCEC1FB275,0x02}},
{{0x68CC7DC265FC0398,0xBA43D8304D1E17AE,0x00}},
{{0x20B805A99A859073,0x946395363F18F22B,0x03}},
{{0xD2D3E5FCF2471BC1,0x8D02B0558408C598,0x02}},
{{0xB1830D9B1DBC050B,0xB56F2BD797B0EC57,0x01}},
{{0x40A9A1FD125E094C,0x3BFFAA8A79CB5527,0x00}},
{{0x4A271AD69BD35EF0,0x3E66E4148838A8E6,0x02}},
{{0x001C9C493CE71863,0xDE5B5B5F684869FF,0x02}},
{{0x350C80920E5A7EE6,0x24B7E105498CE72F,0x04}},
{{0x3A785593668064E8,0xE3A4E361690B3117,0x00}},
{{0x9C5D55B5006BCA17,0x3C5FD60737B20842,0x04}},
{{0x73EAA1FFFC5A687D,0xC117A64CEC52FE32,0x00}},
{{0x55946E1C319DC733,0xAD9C76A7D3DEDF0F,0x00}},
{{0x32EC71064022E30D,0x12C2CE30A4B2ED6A,0x04}},
{{0x7785CB6DBC8FA97A,0x2650ACAB3D4BD363,0x04}},
{{0xE41725FE0A472E40,0xCB5FEEB79FB3E4AD,0x00}},
{{0xEFCC2DD570667CD4,0x56F3F639A4F6B927,0x03}},
{{0xDCB3D4956928D826,0x01B85A40E7062B45,0x02}},
{{0x23F9DE411DB441AF,0xA9941A0E7BDF6661,0x00}},
{{0x9B55CA9A385BB987,0x76D72EE6D2D6D138,0x00}},
{{0xABA3EFFCFC057058,0x1F974542D9CCECB9,0x03}},
{{0xD7927053DB804A65,0x1F7551C4FBE73047,0x03}},
{{0x0D3C8C954380B9B0,0x8624C773BEE6C85A,0x00}},
{{0x9EE14FA7F189A480,0x4E49BB829972EF46,0x02}},
{{0x59C37937B40616C4,0x23C837E5E3A93475,0x04}},
{{0x67AC3214A002D110,0x3265CF8C742B0764,0x03}},
{{0x6EF449F19763D490,0xD33269942E8EEC02,0x02}},
{{0x4E0DF23414D98FC4,0xEB78329A31891E6A,0x03}},
{{0xCE1626571BD50735,0x93E68E2D426B2204,0x00}},
{{0x63D79189C498BB79,0x054FC872370032C2,0x02}},
{{0x57996B94F4AC65FC,0x7ABF0471B7905AA1,0x04}},
{{0x3F4871629561EE87,0x1087777055D6F442,0x01}},
{{0x55D1AD2FCA72DF6C,0xA721BBEDAADFF17D,0x02}},
{{0xD1D04B18D35B11BE,0x3C5AD40B7B83B08D,0x01}},
{{0xDA8050BE9787C46D,0x00E885E4A0F09D7E,0x04}},
{{0x8B8A1DC4E541CB23,0xA5AEEA8F36479C74,0x00}},
{{0x47AF3B808BE5150A,0x52C4D170728FC576,0x01}},
{{0x9867A830F080ADE3,0xAA4AADF457DC0DE2,0x01}},
{{0x96D078B4FF32F1E0,0x8A4090AD248A5C5C,0x04}},
{{0x8EA9A4BAACB05E83,0xE316A11647A937FE,0x00}},
{{0x56191458878D2104,0xDC82303044FAF13D,0x02}},
{{0x5C9B70BE482CA60E,0x61FED63ACA4A019D,0x04}},
{{0xC2A3BF6327D75D3F,0x420CBECE5FD3281D,0x00}},
{{0x897DF9831F77EA64,0x4D4C7F1D13A303C5,0x00}},
{{0xF62BFC526F303047,0xA2606A7449C58D47,0x00}},
{{0x71039373B956F389,0xD191856532F425E2,0x03}},
{{0xAF5B16285C28407B,0x35BF5E3B34D224DC,0x04}},
{{0x85D166DF2D7F139D,0xF76E29E75B2C9AC5,0x02}},
{{0xED3C3A65C2A2E496,0x3C6789874EC3FDFD,0x03}},
{{0xFB051F7BDC3454D9,0x30BD38009E2FC0F0,0x03}},
{{0xFDFA9BA13CAEC902,0xC4D12523F33192A7,0x02}},
{{0xBE1E3D4B27D750D7,0x766F13121A830204,0x01}},
{{0x32BF11018E65D22F,0x79E1EF88AA181BAB,0x04}},
{{0xFA27642EF00FBC0C,0x806AE38D1A0D91FE,0x04}},
{{0xA0A9F13DCBD71ADD,0xEDFB1096839D5F70,0x00}},
{{0xD9DF9FC9E51DD6E2,0x1DFABF53AFF3E2D0,0x04}},
{{0xCCF7BE1E65F175DF,0xF52AA522830800E0,0x00}},
{{0xE55C8D9A2FD10B07,0xDBA08562BBE629E6,0x03}},
{{0x4B3EEC87F7186173,0xA60FBE37EE5CF56D,0x02}},
{{0x2A1EF70B8F47BC21,0x5FA4E96439DDE3AA,0x00}},
{{0x878DD830BAD323E2,0xE1048DDD6E3CE661,0x00}},
{{0x9C7CC8A2422BF061,0xECC837C66EF07D37,0x03}},
{{0x26BBE06525D783AC,0x78C0B08C15EAE18A,0x02}},
{{0x15E424B8873986CE,0xFE2EDB9F78797FEF,0x01}},
{{0xB6EBAD14BE6C651B,0x2C2C0C524BCE0BD3,0x01}},
{{0xD25761E9FB0244B6,0x4D8FA20A503A761B,0x02}},
{{0xB0A9F1F7A8154F0E,0xFB24FBBECF48B6FF,0x01}},
{{0xFF8F28A9A42C8C62,0x69C7BA2C2D64CD3D,0x00}},
{{0x42E38F520EE720F1,0xD47D2DE9FF921953,0x00}},
{{0x6EE1187194A4371F,0x56D2802BC606D0AF,0x01}},
{{0x55D02E71933C5F78,0x85C1C46FA0598164,0x02}},
{{0x90C04B8C0CF58B5A,0x6DDB9CA72DC0C932,0x02}},
{{0xF260BA1B6FD72C73,0xEF497EC70BF6B28D,0x03}},
{{0x3200D00DDD25870E,0xEBF60542AC3B62E9,0x02}},
{{0x98C9DD2F6F86BFDB,0x3B7561F2AB0AC618,0x01}},
{{0xC419DE4875F6ECD3,0x8BAFBA97347D72F1,0x02}},
{{0x9B96117AD4F48AB2,0x60988F64978F3D7C,0x02}},
{{0x229D19705B4350E5,0xAEFCCFAF7CE3448E,0x00}},
{{0xBCD4E9FD942106D5,0xD179BD5A14AA6CED,0x02}},
{{0x75DCF8B522F88428,0x39455E3DF163AE8D,0x04}},
{{0x4DCB16477932671B,0x26568B064958706F,0x04}},
{{0x931AC19821D0770B,0x267B62FC02C8F2CB,0x02}},
{{0x8D5C534AAEC3E1C6,0x4DC1543810AE701A,0x02}},
{{0xD6CAFB31DDE5BEF5,0xBF78A83D1598D4B3,0x02}},
{{0x5FBAE681548E60E0,0x4C78F6689D479EBC,0x00}},
{{0xBA62FEE5496A5906,0xEC4CC1D647F791E6,0x01}},
{{0xC3E67A45A5AF7BC4,0xBCC8A8941CAC2C85,0x00}},
{{0xC38E410445A8E306,0x988E4B9ACBCDFF5C,0x00}},
{{0x655066F6E648DA58,0x6ED2B9A4C91EB585,0x00}},
{{0xE30B49BA9F9DEDA5,0x9C12EB0ADEB498C5,0x02}},
{{0xFEDCDCE4CBE77E6A,0x46CE676260E7F932,0x02}},
{{0x46B256CAF0E01C00,0x6B153BF9BC8639FE,0x02}},
};

__device__ uint131_t _gy[131] = {
{{0x4B5A2A8F9B90CBEF,0x7DABB39A1BB0A5FA,0x02}},
{{0x4584903465D793EF,0x1727A0E5D7BAA4CB,0x01}},
{{0x7763A40249E52170,0xF7AC6433D09EC60C,0x01}},
{{0xB1103D5A013328B3,0xDB24EA0578A38DF4,0x00}},
{{0x953DE45884F21F9E,0xCDCF28929FEFA614,0x03}},
{{0x999496DFCC09B90E,0x618F55FEA4954CC9,0x03}},
{{0xFC9EAA351E3E45A7,0x95BC09803B0C18A9,0x00}},
{{0x0EF0F0A8F9A70877,0xDEB93E62B4F8BB8A,0x00}},
{{0x7B50623D6A9AB09D,0xF35EA8E8D22D1577,0x00}},
{{0x83A3D2D8E3C8330A,0xB603B0034DEEFB63,0x01}},
{{0x628DDEF6C18BA663,0xB785EF5079FF7F86,0x03}},
{{0x279D26E1D63C41D2,0x027F03BC891F2DAB,0x02}},
{{0x3DACCDBA4B46BB2E,0x17D8DE57C18A2755,0x04}},
{{0x96655A833663D5A7,0xE23AA7B0814DDD4A,0x02}},
{{0x051D85318B26FBA7,0xAF44E25F44E3E483,0x03}},
{{0xE6A0505B96801499,0x5124F0D26058DD7D,0x02}},
{{0xDDB6ECDA9F0A1A01,0x6C9C5AC9F2DD94AD,0x01}},
{{0x71B9D60EEC890322,0xF3160252B75D6687,0x02}},
{{0x73381DF1F23257D5,0x37881BF3119E0EDB,0x03}},
{{0x9E4490C8FF3C8624,0x25222058C8EACA61,0x02}},
{{0x7629D9B612276320,0x77F2AD499C2EB449,0x04}},
{{0xD32080EE2CD79D97,0x6C110CA3C2C7BE5B,0x00}},
{{0x411ABB4145AE32F3,0xFF83FA05E7AA2D96,0x03}},
{{0x109E5420C534E1F7,0x3106779B76E71903,0x00}},
{{0xB011BE2D3C84EF15,0x2FDC26427267751D,0x02}},
{{0x157236CC57F18895,0x247EB3730606C9BC,0x00}},
{{0xC09F25EA558D2DCC,0xF60893B5130B5122,0x01}},
{{0xB718D1CF04F8BE06,0x368E55B7C81D27E0,0x04}},
{{0x3323717D54A09BC0,0x742AA13B841CEC10,0x02}},
{{0x86C32E04305F4994,0x808F9CC07AB6C16B,0x04}},
{{0x87396C33C5E2461A,0xA47165C46C0E8EE5,0x00}},
{{0x430260952026B676,0x6611AF78559B8CB2,0x03}},
{{0x75D02CBFAA7C0440,0x62E0BCF4E114BD5E,0x01}},
{{0xEE10EFCF99163D36,0x39F60C14EC7F1581,0x04}},
{{0x13AA5369D33B6979,0x018D3F73CF1F3BE6,0x04}},
{{0x20EB5AEFB4C46A0E,0x4F8057A6D009DC35,0x03}},
{{0xFEF642BF87D49368,0x2E72CCBCABC6B04D,0x00}},
{{0x3872F2E0B19502B9,0x3782B5D116D54F97,0x01}},
{{0x9E93B2B9E23F236B,0x59F7B96A7091FCBE,0x01}},
{{0xC710E5ED8EAFE288,0x490AF78C28CE8B96,0x00}},
{{0x7E24E615007F232E,0x453F6467DD6C9307,0x00}},
{{0x61D36CD231323B8C,0xE56418819B8D96B4,0x01}},
{{0x9ADA20D50AA6065A,0x2CF2C86553D0C023,0x02}},
{{0xAF87A36CCFA1CCC3,0x58C2673353525D0F,0x03}},
{{0x4EB77D2F7937CF76,0x39B4552235A36037,0x04}},
{{0xFE9CF61AAF6FDACF,0x87712B43CEACF33A,0x03}},
{{0x8AF2ECAED45DB8CE,0x612B2B2A4DC9BFAA,0x00}},
{{0x0167782C758246A6,0x1D559792D02DC910,0x03}},
{{0x666173B33E676BF1,0xF6977CDDAD16BFB5,0x02}},
{{0x94513A965F4EA68D,0x09DD62B93792A71A,0x04}},
{{0xC8BB547A2B2A734F,0x5821DA0CF85403EE,0x00}},
{{0x2D5545007489ED7E,0x3F68DDAF44E81F76,0x00}},
{{0x404E46E07338DA9F,0xB312752EFBD23071,0x01}},
{{0x0E1AFE41E7B8A674,0x8AB67AC61E547A64,0x00}},
{{0xBFB27661706DA2FD,0x323C87DD2215F6E6,0x01}},
{{0x900887D5D82AAC61,0x35132DB046334D60,0x01}},
{{0x981B472B31DE143E,0xBC42356B661F7C90,0x03}},
{{0xEB193DE441ABB4A3,0x4B46D77159E30A5F,0x04}},
{{0xC3B4C68DFD7934F4,0xA648598F785A0373,0x01}},
{{0xBE6B17748B41A324,0x95CA69392DCA9D99,0x00}},
{{0xB372F962A586A1E2,0x5D9C73FA13E8A4D2,0x03}},
{{0x0EE722EE62C7AB09,0xB1734B7B79A41056,0x03}},
{{0x6682A3F858BC1205,0xE0A16761C034C01A,0x02}},
{{0x8770F7897B10B3D0,0xB109D48AD3D509B9,0x03}},
{{0xE46C8B37C509A2A2,0x30870782D0E234D6,0x01}},
{{0x873AA6C12C947D42,0x6825E402E32BDC7B,0x02}},
{{0xDB157C6C28A1B2C5,0x1EF696AFC783CB65,0x04}},
{{0xBCC5483619D50A08,0x9B6469B29C882791,0x02}},
{{0x5C8D15AE4F6B8F70,0x2F2F3AB1B1C55AA8,0x03}},
{{0x8D95136147F91235,0x8A8865FDD8A2DE45,0x02}},
{{0x0C9BA196C4C489B3,0x0164EE96E7E21E3D,0x04}},
{{0xCCA7D41980B733DF,0xAEEDD567818BC5A5,0x03}},
{{0x6AF03A989AB856FF,0xC04FCEB62C85FE24,0x00}},
{{0x5A036B5E94EBFF1B,0xA8D36D386E6A54BB,0x02}},
{{0xDF93FBC5D2243BF3,0x8EEF1353083866AF,0x01}},
{{0xD48CED1947EAC592,0x26B882BE06064D21,0x02}},
{{0x98740C97E194D678,0x4270F77A6468F17E,0x04}},
{{0x355F62FEA6EC18E2,0xFDA56EFD40253E32,0x02}},
{{0x4F608991F0CEF02F,0xB282CD0DBFA7C27D,0x01}},
{{0x54033B4D8D117624,0x8F997312E6BD7D59,0x02}},
{{0x0571EC3105A19065,0x632290DF7C473D5B,0x03}},
{{0x56C8C6E2008A22EE,0xFFCE312B332B58CB,0x03}},
{{0x8B65307B2E28A738,0xFF345F378692D0FC,0x00}},
{{0xEA595D6381DB7BF0,0x02BDB92621DFA2A9,0x01}},
{{0xBB6D65F6223D6FFC,0x0DDB1A1468DEA899,0x03}},
{{0xB21DBBD268307BD6,0x836754BDD9508DEE,0x02}},
{{0xC1F15834F7D49EC1,0x9E1E54DE8D65F515,0x02}},
{{0xE60EA8EBD5AD5753,0xF01934B860EF2BE1,0x02}},
{{0x7C1E670F9D788BAE,0x44DDFA44E016523D,0x02}},
{{0x3D7C236BE1B22B7B,0x48AE9DF62182125A,0x03}},
{{0x663FBB0FE401D56D,0xC0D4773AE9419F7C,0x01}},
{{0xDDBC3C8155FC4027,0x5608B3D472C24419,0x01}},
{{0x47D36D50E6709834,0xD0A0F9627D5B0E49,0x03}},
{{0x0880D1CBA4BC5BF0,0x6F1E640131D72C32,0x03}},
{{0x144380B4F7354ED2,0x52C1F95FA4FED0BB,0x03}},
{{0x1A5E4E264CD9BE27,0x4ECCB8447A56CA01,0x00}},
{{0x450EE71C2BAA6150,0x2A725E5560EE8EC3,0x01}},
{{0x3115C437DC4A2804,0x59F43CFB2D3185D1,0x00}},
{{0x9266DCD1A2727B76,0x7FA7008A1A140AF5,0x02}},
{{0x3870A6585C96E029,0x11F41AB84CFE3782,0x02}},
{{0x9C847B5FA27363BA,0x50C0E82694EBD63E,0x03}},
{{0xA3E3F0E49B3B857D,0x1443C302584C0A6C,0x04}},
{{0x34F1A6FA44136A7E,0x669709ED70982D02,0x04}},
{{0x054BDC43FC961705,0x55C22EB22B5EAD25,0x03}},
{{0x6A74D0571F3626A2,0x3430985C4D43DC9B,0x03}},
{{0xA0E41151380433D5,0x0DE1F0580FA60B90,0x02}},
{{0x672089DA252CE3B7,0x249D48BA9174BBCA,0x03}},
{{0x5271D906EB439FB4,0xD0A6D18C8C9B89F0,0x03}},
{{0x9389087880857641,0xB3FA39E5173A5AAA,0x02}},
{{0x4754F215FEDA46E5,0x88AA574E2C8E7775,0x03}},
{{0x31916D4AD6E52051,0xE452A21324D8AEDD,0x03}},
{{0xEE4A4CADF07A3A5D,0x932EECC200453177,0x00}},
{{0xF7C8CCE15CE17456,0x5947F57E79901ACF,0x03}},
{{0xBB3FF3B5359CEB8F,0xD8C7C0ED5C8E0653,0x02}},
{{0xD6BAED7A872E07C0,0xC0AFAB002F0E6A8B,0x02}},
{{0x38FD762D269C5691,0x366C5987D7BE3F5E,0x03}},
{{0xA0ECED07A4CBB836,0x2048F1BD6C659845,0x04}},
{{0xF17E12ED0CA69B61,0x10B196B1C1749390,0x02}},
{{0xC4F83C7BE8BB4C29,0xCCD2E79E01C9576C,0x01}},
{{0xF1E445BB86FF1789,0xD49D5C5DF50577BC,0x00}},
{{0x481AC7E52B38CA0B,0x2AA977FBF3EF1BC9,0x02}},
{{0x50FC1546CE4578D7,0x9D025235A18EA05D,0x03}},
{{0x6ACF01F753F3F711,0xDFF3AE6158C90629,0x03}},
{{0xEF68D7BD3C3008F4,0xE50A8D0B781C6FA3,0x01}},
{{0x3899C25EBF107D34,0xCE71F904F9E4A0B5,0x00}},
{{0x11B08E9BCF50FEB3,0xFE8DE89FF4A32468,0x01}},
{{0xE572443537DA4ACB,0x29D3BF3F8D356327,0x04}},
{{0x85E5345E9659DBD0,0x0E0F605CC22AFDB2,0x04}},
{{0xAE7C2C840175E7B2,0x9591C9CE87981257,0x01}},
{{0xDE07AB0B381DC386,0x0034F421F9322394,0x01}},
{{0x102DBAC4C2508E37,0x492802329D937114,0x00}},
};

#endif